# JS 模块化

**历史背景**

- 早期并无模块化 or 命名空间的概念，JS 本身就是为了满足简单的页面设计(表单提交/动画);
- 伴随需求的增加，页面变得复杂，为使代码不变得臃肿则开始进行文件拆分(多个 script 标签引入);
- 一个 HTML 文件可能需要引入多个 JS 文件，而 JS 文件又分散在不同文件中;
- 同时又伴随有变量污染的问题需要解决;
- 为解决这些问题，需要一个模块管理器，能统一管理这些模块(模块的定义、获取);
- 并进行作用域把控(IIFE 语法侧的优化);

**模块规范: CommonJS / AMD / CMD / UMD / ES6 Module**

- CommonJS

1. Node.js 所采用该规范;
2. 服务端模块重用，NPM 中模块包多(服务端编程所用到的模块都存于本地硬盘);
3. 加载模块是同步的，不适合浏览器环境(异步加载);

- AMD

1. Require.js 所采用该规范;
2. 依赖前置，实现异步加载，可并行加载多个模块，加载速度快，允许制定回调函数;
3. 模块定义方式的语义不顺畅，不保证加载顺序，开发成本较高，是一种妥协的实现方案;

- CMD

1. Sea.js 所采用该规范;
2. 按需加载，依赖就近，延迟执行;
3. 只有在使用的时候才会解析、执行 js 文件，执行等待时间会叠加;
4. 加载逻辑存在于每个模块中，扩大了模块体积，同时功能上依赖 SPM 打包和编译;

- UMD: AMD & CommonJS 的一个糅合

- ES6 Module

1. 在语言标准的层面上，实现了模块功能，旨在成为浏览器和服务器通用的模块解决方案;
2. CommonJS 模块输出的是一个值的拷贝，ES6 模块输出的是值的引用;
3. CommonJS 模块是运行时加载，ES6 模块是编译时输出接口;

*https://zhuanlan.zhihu.com/p/467991875*

_JS 文件_

- index.js 开发一个简易的模块管理工具
